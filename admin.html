<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Encrypt Message</title>
</head>
<body>
  <h1>Encrypt Message</h1>

  <button id="encrypt-button">Encrypt</button>

  <h3>Encrypted Data and IV</h3>
  <p id="encryptedData"></p>
  <p id="ivData"></p>

  <script>
    async function encryptMessage(password, message) {
      const encoder = new TextEncoder();
      const passwordBytes = encoder.encode(password);
      const messageBytes = encoder.encode(message);

      // Generate a key from the password using PBKDF2
      const key = await crypto.subtle.importKey(
        "raw",
        passwordBytes,
        { name: "PBKDF2" },
        false,
        ["deriveKey"]
      );

      // Generate a random Initialization Vector (IV)
      const iv = crypto.getRandomValues(new Uint8Array(16));  // 16-byte IV

      // Encrypt the message with AES-GCM
      const encryptedData = await crypto.subtle.encrypt(
        { name: "AES-GCM", iv: iv },
        key,
        messageBytes
      );

      // Convert encrypted data and IV to hexadecimal format for easy sharing
      const encryptedHex = bufferToHex(encryptedData);
      const ivHex = bufferToHex(iv);

      return { encryptedHex, ivHex };
    }

    // Helper function to convert ArrayBuffer to hex string
    function bufferToHex(buffer) {
      const view = new Uint8Array(buffer);
      return Array.from(view).map(b => b.toString(16).padStart(2, '0')).join('');
    }

    // Handle encryption when the button is clicked
    document.getElementById('encrypt-button').addEventListener('click', async () => {
      const password = "bruh@123";  // Your password
      const message = "pass";       // The message you want to encrypt

      // Encrypt the message
      const { encryptedHex, ivHex } = await encryptMessage(password, message);

      // Display the encrypted data and IV on the page
      document.getElementById('encryptedData').textContent = `Encrypted Data: ${encryptedHex}`;
      document.getElementById('ivData').textContent = `IV: ${ivHex}`;
    });
  </script>
</body>
</html>
